module.exports=[37936,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"registerServerReference",{enumerable:!0,get:function(){return d.registerServerReference}});let d=a.r(11857)},13095,(a,b,c)=>{"use strict";function d(a){for(let b=0;b<a.length;b++){let c=a[b];if("function"!=typeof c)throw Object.defineProperty(Error(`A "use server" file can only export async functions, found ${typeof c}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`),"__NEXT_ERROR_CODE",{value:"E352",enumerable:!1,configurable:!0})}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"ensureServerEntryExports",{enumerable:!0,get:function(){return d}})},21070,a=>{"use strict";var b=a.i(37936),c=a.i(66518),d=a.i(18558),e=a.i(72849),f=a.i(5246),g=a.i(4924),h=a.i(9633),i=a.i(13095);let j=new TextEncoder().encode(process.env.JWT_SECRET||"rahasia-negara-mabadiul-ihsan-2026");async function k(a){try{let b=a.get("name"),f=a.get("username"),g=a.get("password"),h=a.get("role");if(!f||!g||!b)return{success:!1,message:"Nama, Username, dan Password wajib diisi."};if(await c.prisma.user.findUnique({where:{username:f}}))return{success:!1,message:"Username sudah digunakan!"};let i=await e.default.hash(g,10);return await c.prisma.user.create({data:{name:b,username:f,password:i,role:h||"admin"}}),(0,d.revalidatePath)("/admin/users"),{success:!0,message:"User berhasil ditambahkan!"}}catch(a){return console.error("Create User Error:",a),{success:!1,message:"Terjadi kesalahan saat membuat user."}}}async function l(a,b){try{let i=b.get("name"),k=b.get("username"),l=b.get("password"),m=b.get("role"),n={name:i,username:k,role:m};l&&""!==l.trim()&&(n.password=await e.default.hash(l,10));let o=await c.prisma.user.update({where:{id:a},data:n}),p=await (0,f.cookies)(),q=p.get("admin_session")?.value;if(q)try{let{payload:b}=await (0,h.jwtVerify)(q,j);if(b.id===a){let a=await new g.SignJWT({id:o.id,username:o.username,role:o.role,name:o.name}).setProtectedHeader({alg:"HS256"}).setExpirationTime("24h").sign(j);p.set("admin_session",a,{httpOnly:!0,secure:!0,maxAge:86400,path:"/",sameSite:"strict"})}}catch(a){console.warn("Gagal refresh token otomatis:",a)}return(0,d.revalidatePath)("/admin/users"),(0,d.revalidatePath)("/admin/dashboard"),{success:!0,message:"Data user berhasil diperbarui!"}}catch(a){return console.error("Update User Error:",a),{success:!1,message:"Gagal update user. Username mungkin duplikat."}}}async function m(a){try{if(1===a)return{success:!1,message:"Admin Utama tidak bisa dihapus!"};return await c.prisma.user.delete({where:{id:a}}),(0,d.revalidatePath)("/admin/users"),{success:!0,message:"User berhasil dihapus."}}catch(a){return console.error("Delete User Error:",a),{success:!1,message:"Gagal menghapus user."}}}(0,i.ensureServerEntryExports)([k,l,m]),(0,b.registerServerReference)(k,"401e5dada247b9d841c50c2513a32ca1e51461bea4",null),(0,b.registerServerReference)(l,"6042f7a7ba4d1b6ef48aa692a519d0574b8876af84",null),(0,b.registerServerReference)(m,"40065b6c50712262e0e90428809ca0329764d08dba",null),a.s(["createUser",()=>k,"deleteUser",()=>m,"updateUser",()=>l])},63306,a=>{"use strict";var b=a.i(63707),c=a.i(21070);a.s([],1176),a.i(1176),a.s(["0092b0907e68a3999a3d165d87486d112e619ba333",()=>b.logoutAction,"401e5dada247b9d841c50c2513a32ca1e51461bea4",()=>c.createUser],63306)}];

//# sourceMappingURL=_0b7ac603._.js.map